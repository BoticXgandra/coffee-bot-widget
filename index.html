<!DOCTYPE html>
<html lang="en">
<head>...</head>
<body>
    <div id="chat-widget-container">...</div>
    <div id="chat-launcher">...</div>

    <script>
        // --- SITEMAP DATA IS NOW LOADED DYNAMICALLY ---
        let SITEMAP = []; // Start with an empty sitemap

        // All other functions (isCoffeeRelated, searchSitemap, etc.) remain the same...

        // --- UPDATED: Load sitemap automatically when the widget starts ---
        document.addEventListener("DOMContentLoaded", () => {
            const launcher = document.getElementById('chat-launcher');
            const widget = document.getElementById('chat-widget-container');
            const closeBtn = document.getElementById('close-widget-btn');

            launcher.addEventListener("click", () => { /* ... */ });
            closeBtn.addEventListener("click", () => { /* ... */ });
            
            // Fetch the live sitemap
            fetch('/.netlify/functions/get-sitemap')
                .then(response => response.json())
                .then(data => {
                    SITEMAP = data;
                    console.log(`Sitemap loaded with ${SITEMAP.length} articles.`);
                    addInitialMessages(); // Show initial messages only after sitemap is loaded
                })
                .catch(error => {
                    console.error('Failed to load sitemap:', error);
                    addInitialMessages(); // Still show initial messages even if sitemap fails
                });
        });

        // The rest of your JavaScript functions go here (addInitialMessages, processMessage, etc.)
        // ...
    </script>
</body>
</html>